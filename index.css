:root {
  /* Light Theme Colors */
  --primary-color: #4f46e5;
  --primary-hover-color: #4338ca;
  --primary-background-subtle: #eef2ff;
  
  --background-color: #f8fafc;
  --card-background-color: #ffffff;
  
  --text-color: #1e293b;
  --text-color-inverted: #ffffff;
  --subtle-text-color: #64748b;
  
  --border-color: #e2e8f0;
  
  --success-color: #22c55e;
  --error-color: #ef4444;
  --error-background-subtle: #fef2f2;

  --ui-background: #f1f5f9;
  --ui-background-hover: #e2e8f0;
  --ui-background-subtle: #f8fafc;
  
  --modal-overlay-color: rgba(15, 23, 42, 0.9);
  --shadow-color-light: rgba(0, 0, 0, 0.07);
  --shadow-color-dark: rgba(0, 0, 0, 0.07);

  /* Font */
  --font-family: 'Inter', sans-serif;
}

html[data-theme="dark"] {
  --primary-color: #6366f1;
  --primary-hover-color: #818cf8;
  --primary-background-subtle: #312e81;

  --background-color: #0f172a;
  --card-background-color: #1e293b;
  
  --text-color: #f1f5f9;
  --text-color-inverted: #1e293b;
  --subtle-text-color: #94a3b8;
  
  --border-color: #334155;
  
  --success-color: #4ade80;
  --error-color: #f87171;
  --error-background-subtle: #451a24;
  
  --ui-background: #334155;
  --ui-background-hover: #475569;
  --ui-background-subtle: #1a2638;
  
  --modal-overlay-color: rgba(0, 0, 0, 0.85);
  --shadow-color-light: rgba(0, 0, 0, 0.2);
  --shadow-color-dark: rgba(0, 0, 0, 0.2);
}

* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: var(--font-family); background-color: var(--background-color); color: var(--text-color); line-height: 1.6; padding: 1rem; transition: background-color 0.3s, color 0.3s; }
@media (min-width: 768px) { body { padding: 2rem; } }
#root { max-width: 900px; margin: 0 auto; }
main { display: flex; flex-direction: column; gap: 2rem; }

/* --- HEADER --- */
header { text-align: center; margin-bottom: 2rem; }
header h1 { font-size: 2.25rem; font-weight: 800; color: var(--text-color); letter-spacing: -0.025em; }
header p { font-size: 1.125rem; color: var(--subtle-text-color); margin-top: 0.5rem; max-width: 600px; margin-left: auto; margin-right: auto; }
.header-actions { margin-top: 1.5rem; display: flex; justify-content: center; gap: 0.75rem; }
.header-button { background-color: var(--card-background-color); border: 1px solid var(--border-color); color: var(--text-color); padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; transition: all 0.2s; display: inline-flex; align-items: center; gap: 0.5rem; box-shadow: 0 1px 2px var(--shadow-color-light); }
.header-button:hover:not(:disabled) { background-color: var(--ui-background-subtle); border-color: var(--primary-color); color: var(--primary-color); }
.header-button:disabled { cursor: not-allowed; opacity: 0.5; }
.header-button svg { width: 18px; height: 18px; }
.reset-button:hover:not(:disabled) {
  background-color: var(--error-background-subtle);
  border-color: var(--error-color);
  color: var(--error-color);
}

/* --- GENERAL & CARD --- */
.card { background-color: var(--card-background-color); border-radius: 1rem; border: 1px solid var(--border-color); padding: 1.5rem; box-shadow: 0 4px 6px -1px var(--shadow-color-light), 0 2px 4px -2px var(--shadow-color-dark); }
@media (min-width: 768px) { .card { padding: 2rem; } }
.step-indicator { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem; border-bottom: 1px solid var(--border-color); padding-bottom: 1rem; }
.step-indicator-content { display: flex; align-items: center; gap: 0.75rem; }
.step-number { width: 2.25rem; height: 2.25rem; border-radius: 50%; display: grid; place-items: center; font-weight: 600; background-color: var(--border-color); color: var(--subtle-text-color); transition: all 0.3s ease; }
.step-title { font-size: 1.25rem; font-weight: 600; color: var(--subtle-text-color); transition: all 0.3s ease; }
.step-indicator.active .step-number { background-color: var(--primary-color); color: var(--text-color-inverted); }
.step-indicator.active .step-title { color: var(--text-color); }
.step-subtitle { color: var(--subtle-text-color); text-align: center; margin-bottom: 1.5rem; max-width: 500px; margin-left: auto; margin-right: auto; }
.step-indicator-actions {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

/* --- PLACEHOLDER / WELCOME --- */
.placeholder-container { text-align: center; padding: 3rem 2rem; }
.placeholder-container h2 { font-size: 1.5rem; margin-bottom: 0.5rem; }
.placeholder-container p { color: var(--subtle-text-color); margin-bottom: 1.5rem; }

/* --- STEP 1: UPLOAD --- */
.upload-area { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 200px; border: 2px dashed var(--border-color); border-radius: 0.75rem; padding: 2rem; cursor: pointer; transition: border-color 0.2s, background-color 0.2s; }
.upload-area:hover { border-color: var(--primary-color); background-color: var(--primary-background-subtle); }
.upload-area p { color: var(--subtle-text-color); }
.upload-area span { color: var(--primary-color); font-weight: 500; }

/* --- STEP 2: PROCESS (BATCH THUMBNAILS) --- */
.product-thumbnail-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 1rem; }
.product-thumbnail { position: relative; aspect-ratio: 1 / 1; border: 2px solid var(--border-color); border-radius: 0.5rem; overflow: hidden; }
.product-thumbnail.processed { border-color: var(--success-color); }
.product-thumbnail img { width: 100%; height: 100%; object-fit: cover; }
.product-thumbnail-overlay {
  position: absolute;
  inset: 0;
  background: rgba(15, 23, 42, 0.6);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 0.5rem;
  color: #fff;
  z-index: 4;
}
.thumbnail-actions { display: flex; gap: 0.5rem; }
.thumbnail-actions button { flex: 1; font-size: 0.75rem; padding: 0.3rem; border-radius: 0.25rem; border: none; cursor: pointer; background-color: rgba(255,255,255,0.9); color: #1e293b; transition: background-color 0.2s; }
.thumbnail-actions button:hover:not(:disabled) { background-color: white; }
.thumbnail-actions button:disabled { opacity: 0.7; cursor: not-allowed; }
.remove-thumbnail-button {
  position: absolute;
  top: 6px;
  right: 6px;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background-color: color-mix(in srgb, var(--card-background-color) 30%, transparent);
  backdrop-filter: blur(4px);
  color: var(--text-color);
  border: 1px solid var(--border-color);
  cursor: pointer;
  font-size: 16px;
  font-weight: bold;
  line-height: 1;
  display: grid;
  place-items: center;
  opacity: 0;
  transform: scale(0.8);
  transition: all 0.2s ease-in-out;
  z-index: 5;
}
.product-thumbnail:hover .remove-thumbnail-button {
  opacity: 1;
  transform: scale(1);
}
.remove-thumbnail-button:hover {
  background-color: var(--error-color);
  color: white;
  border-color: var(--error-color);
  transform: scale(1.1);
}
.add-more-button { background-color: var(--ui-background); color: var(--text-color); border: 1px solid var(--border-color); padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; transition: all 0.2s; display: inline-flex; align-items: center; gap: 0.5rem; }
.add-more-button:hover:not(:disabled) { background-color: var(--ui-background-hover); border-color: var(--primary-color); color: var(--primary-color); }
.add-more-button:disabled { opacity: 0.6; cursor: not-allowed; }
.add-more-button svg { width: 16px; height: 16px; }

/* --- STYLE SELECTION & SUMMARY --- */
.style-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1rem; }
.style-card { display: flex; flex-direction: column; text-align: left; gap: 0.5rem; padding: 1rem; border: 2px solid var(--border-color); border-radius: 0.75rem; background-color: var(--card-background-color); cursor: pointer; transition: all 0.2s ease-in-out; }
.style-card:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px var(--shadow-color-light), 0 4px 6px -4px var(--shadow-color-dark); border-color: var(--primary-hover-color); }
.style-card-header { display: flex; align-items: center; gap: 0.75rem; }
.style-icon svg { width: 24px; height: 24px; stroke: var(--primary-color); }
.style-name { font-weight: 600; font-size: 1.05rem; color: var(--text-color); }
.style-description { font-size: 0.875rem; color: var(--subtle-text-color); line-height: 1.5; }
.selected-summary { background-color: var(--primary-background-subtle); border: 2px solid var(--primary-color); border-radius: 0.75rem; padding: 1.5rem; text-align: center; }
.selected-summary h3 { font-size: 1.25rem; color: var(--primary-color); }
.selected-summary p { color: var(--subtle-text-color); margin-top: 0.5rem; margin-bottom: 1rem; }
.change-button { background-color: var(--ui-background); color: var(--text-color); border: 1px solid var(--border-color); padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; transition: background-color 0.2s, border-color 0.2s; }
.change-button:hover { background-color: var(--ui-background-hover); border-color: var(--subtle-text-color); }

/* --- PRESETS --- */
.presets-section { border-bottom: 1px solid var(--border-color); margin-bottom: 1.5rem; padding-bottom: 1.5rem; }
.presets-section h4 { font-size: 1.1rem; color: var(--text-color); margin-bottom: 0.75rem; }
.preset-controls { display: flex; gap: 0.5rem; margin-bottom: 0.75rem; }
.preset-controls input { flex-grow: 1; font-size: 1rem; padding: 0.65rem 1rem; border: 1px solid var(--border-color); border-radius: 0.5rem; background-color: var(--card-background-color); color: var(--text-color); }
.preset-controls button { background-color: var(--primary-color); color: var(--text-color-inverted); border: none; border-radius: 0.5rem; padding: 0 1.5rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s; white-space: nowrap; }
.preset-controls button:disabled { background-color: #a5b4fc; cursor: not-allowed; }
.preset-list { display: flex; flex-wrap: wrap; gap: 0.5rem; }
.preset-item { display: flex; align-items: center; background-color: var(--ui-background); border-radius: 0.5rem; overflow: hidden; }
.preset-item span { padding: 0.5rem 1rem; font-weight: 500; }
.preset-item-actions button { background-color: var(--ui-background-hover); border: none; padding: 0.5rem; cursor: pointer; transition: background-color 0.2s; }
.preset-item-actions button:hover { background-color: #cbd5e1; }
.preset-item-actions button.delete:hover { background-color: var(--error-color); color: white; }


/* --- BACKGROUNDS CAROUSEL --- */
.carousel-wrapper { position: relative; margin: 0 -1rem; }
.carousel-container { display: flex; gap: 1rem; overflow-x: auto; scroll-behavior: smooth; scrollbar-width: none; -ms-overflow-style: none; padding: 1rem; scroll-snap-type: x mandatory; align-items: flex-start; }
.carousel-container::-webkit-scrollbar { display: none; }
.carousel-card { flex: 0 0 280px; scroll-snap-align: start; background-color: var(--ui-background-subtle); border: 1px solid var(--border-color); border-radius: 0.75rem; padding: 1rem; max-height: 450px; overflow-y: auto; }
.carousel-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); }
.carousel-card h3 { font-size: 1.1rem; color: var(--text-color); margin: 0; padding: 0; border: none; }
.generate-idea-button { background-color: var(--ui-background); border: 1px solid var(--border-color); width: 28px; height: 28px; border-radius: 50%; cursor: pointer; display: grid; place-items: center; transition: all 0.2s; color: var(--subtle-text-color); }
.generate-idea-button:hover:not(:disabled) { background-color: var(--primary-background-subtle); border-color: var(--primary-color); color: var(--primary-color); }
.generate-idea-button:disabled { cursor: not-allowed; opacity: 0.7; }
.generate-idea-button svg { width: 16px; height: 16px; }
.generate-idea-button .spinner-ui { width: 14px; height: 14px; }
.background-options-list { display: flex; flex-direction: column; gap: 0.5rem; }
.background-button { background-color: var(--card-background-color); border: 1px solid var(--border-color); padding: 0.75rem; border-radius: 0.5rem; cursor: pointer; transition: all 0.2s; font-weight: 500; text-align: left; color: var(--text-color); font-size: 0.9rem; }
.background-button:hover { border-color: var(--primary-color); color: var(--primary-color); }
.background-button.selected { border-color: var(--primary-color); background-color: var(--primary-background-subtle); color: var(--primary-color); font-weight: 600; }
.carousel-nav { position: absolute; top: 50%; transform: translateY(-50%); z-index: 10; background-color: color-mix(in srgb, var(--card-background-color) 80%, transparent); border: 1px solid var(--border-color); border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 24px; line-height: 38px; text-align: center; box-shadow: 0 2px 5px var(--shadow-color-light); color: var(--text-color); }
.carousel-nav:hover { background-color: var(--card-background-color); border-color: var(--primary-color); }
.carousel-nav.left { left: 0; } .carousel-nav.right { right: 0; }
.custom-prompt-section { display: flex; gap: 0.5rem; margin-top: 1.5rem; }
.prompt-input { flex-grow: 1; font-size: 1rem; padding: 0.65rem 1rem; border: 1px solid var(--border-color); border-radius: 0.5rem; background-color: var(--card-background-color); color: var(--text-color); }
.add-button { background-color: var(--primary-color); color: var(--text-color-inverted); border: none; border-radius: 0.5rem; padding: 0 1.5rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s; }
.add-button:disabled { background-color: var(--primary-hover-color); opacity: 0.6; cursor: not-allowed; }

/* --- REVIEW SECTION --- */
.review-list { display: flex; flex-direction: column; gap: 0.75rem; }
.review-item-wrapper { background-color: var(--ui-background-subtle); border: 1px solid var(--border-color); border-radius: 0.5rem; transition: box-shadow 0.2s; }
.review-item { display: flex; align-items: center; justify-content: space-between; gap: 1rem; padding: 0.5rem 1rem; font-size: 0.9rem; }
.review-item-name { font-weight: 500; color: var(--text-color); }
.review-item-controls { display: flex; align-items: center; gap: 0.75rem; }
.review-item-controls span { font-weight: 600; min-width: 20px; text-align: center; color: var(--primary-color); }
.count-button { width: 24px; height: 24px; border-radius: 50%; border: 1px solid var(--border-color); background-color: var(--card-background-color); color: var(--subtle-text-color); cursor: pointer; font-size: 1rem; font-weight: 600; line-height: 1; display: grid; place-items: center; transition: all 0.2s; }
.count-button:hover:not(:disabled) { border-color: var(--primary-color); color: var(--primary-color); }
.count-button:disabled { background-color: var(--ui-background-subtle); color: #cbd5e1; cursor: not-allowed; }
.remove-button { background: transparent; border: none; cursor: pointer; color: var(--subtle-text-color); font-size: 1.5rem; line-height: 1; padding: 0; }
.remove-button:hover { color: var(--error-color); }
.clear-button { background: transparent; border: 1px solid var(--border-color); color: var(--subtle-text-color); padding: 0.4rem 0.8rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; font-size: 0.875rem; transition: all 0.2s; }
.clear-button:hover { border-color: var(--error-color); background-color: var(--error-background-subtle); color: var(--error-color); }

/* --- CUSTOMIZATION PANEL --- */
.customize-button { background-color: var(--ui-background); color: var(--subtle-text-color); border: 1px solid var(--border-color); padding: 0.3rem 0.8rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; font-size: 0.8rem; transition: all 0.2s; }
.customize-button:hover { border-color: var(--primary-color); color: var(--primary-color); background-color: var(--primary-background-subtle); }
.directions-panel { padding: 1rem; border-top: 1px solid var(--border-color); background-color: var(--card-background-color); display: flex; flex-direction: column; gap: 1.5rem; }
.direction-category { display: flex; flex-direction: column; gap: 0.75rem; }
.direction-category h4 { font-size: 0.9rem; font-weight: 600; color: var(--text-color); }
.direction-options { display: flex; flex-wrap: wrap; gap: 0.5rem; }
.direction-button { background-color: var(--ui-background-subtle); color: var(--text-color); border: 1px solid var(--border-color); padding: 0.4rem 0.8rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; font-size: 0.8rem; transition: all 0.2s; }
.direction-button:hover { border-color: var(--primary-color); color: var(--primary-color); }
.direction-button.selected { border-color: var(--primary-color); background-color: var(--primary-color); color: var(--text-color-inverted); }
.direction-description { font-size: 0.85rem; color: var(--subtle-text-color); margin-top: -0.25rem; }
.negative-prompt-input { font-size: 0.9rem; padding: 0.5rem 0.75rem; border: 1px solid var(--border-color); border-radius: 0.5rem; width: 100%; background-color: var(--card-background-color); color: var(--text-color); }

/* Smart Color Toggle Switch */
.smart-color-category { gap: 1rem; }
.toggle-switch-container { display: flex; align-items: center; gap: 0.75rem; }
.toggle-switch-container span { font-weight: 500; font-size: 0.9rem; }
.toggle-switch { position: relative; display: inline-block; width: 44px; height: 24px; }
.toggle-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; }
.slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; }
input:checked + .slider { background-color: var(--primary-color); }
input:checked + .slider:before { transform: translateX(20px); }
.slider.round { border-radius: 24px; }
.slider.round:before { border-radius: 50%; }

/* --- GENERATE BUTTON --- */
.generate-section {
  margin-top: 1.5rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
}
.review-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  margin-bottom: 0.5rem;
}
.total-images-indicator { font-size: 0.9rem; font-weight: 500; color: var(--subtle-text-color); transition: color 0.2s; }
.total-images-indicator.limit-exceeded { color: var(--error-color); font-weight: 600; }
.generate-button { background-color: var(--primary-color); color: var(--text-color-inverted); font-size: 1.125rem; font-weight: 600; border: none; border-radius: 0.5rem; padding: 1rem 2rem; cursor: pointer; transition: background-color 0.2s, box-shadow 0.2s; display: flex; align-items: center; justify-content: center; gap: 0.75rem; min-width: 200px; width: 100%; }
.generate-button:hover:not(:disabled) { background-color: var(--primary-hover-color); box-shadow: 0 10px 15px -3px var(--shadow-color-light), 0 4px 6px -4px var(--shadow-color-dark); }
.generate-button:disabled { background-color: var(--primary-hover-color); opacity: 0.6; cursor: not-allowed; box-shadow: none; }
.secondary-button {
  background-color: var(--ui-background);
  color: var(--text-color);
  border: 1px solid var(--border-color);
  padding: 0.5rem 1rem;
  font-size: 0.9rem;
  border-radius: 0.5rem;
  cursor: pointer;
  font-weight: 500;
  transition: all 0.2s;
}
.secondary-button:hover:not(:disabled) {
  background-color: var(--ui-background-hover);
  border-color: var(--primary-color);
  color: var(--primary-color);
}
.secondary-button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* --- RESULTS SECTION --- */
.results-section { text-align: center; }
.results-section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
}
.results-section h2 { font-size: 1.75rem; margin-bottom: 0; }
.result-group { margin-bottom: 2rem; }
.result-group-header { display: flex; justify-content: space-between; align-items: center; font-size: 1.25rem; text-align: left; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); }
.download-all-button { background-color: var(--success-color); color: white; border: none; border-radius: 0.5rem; padding: 0.5rem 1rem; font-weight: 600; font-size: 0.875rem; cursor: pointer; transition: background-color 0.2s; }
.download-all-button:hover { background-color: #16a34a; }
.results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; }
.result-image-container { position: relative; width: 100%; aspect-ratio: 1 / 1; overflow: hidden; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px var(--shadow-color-light), 0 2px 4px -2px var(--shadow-color-dark); cursor: pointer; }
.result-image { width: 100%; height: 100%; object-fit: cover; display: block; transition: transform 0.3s ease, filter 0.3s ease; }
.result-image-container:hover .result-image { transform: scale(1.05); filter: brightness(0.7); }
.result-image-overlay { position: absolute; inset: 0; background-color: rgba(15, 23, 42, 0.7); display: flex; align-items: center; justify-content: center; opacity: 0; transition: all 0.3s ease; pointer-events: none; }
.result-image-container:hover .result-image-overlay { opacity: 1; pointer-events: auto; }

/* New Overlay Buttons */
.overlay-edit-button { background-color: color-mix(in srgb, var(--card-background-color) 90%, transparent); color: var(--text-color); border: none; border-radius: 999px; padding: 0.75rem 1.5rem; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 0.5rem; transform: scale(0.9); opacity: 0; }
.result-image-container:hover .overlay-edit-button { transform: scale(1); opacity: 1; transition-delay: 0.1s; }
.overlay-edit-button:hover:not(:disabled) { background-color: var(--card-background-color); transform: scale(1.05); }
.overlay-edit-button svg { width: 18px; height: 18px; }

.overlay-actions-corner { position: absolute; top: 0.75rem; right: 0.75rem; display: flex; gap: 0.5rem; }
.overlay-icon-button { background-color: color-mix(in srgb, var(--card-background-color) 80%, transparent); color: var(--text-color); border: none; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; transition: all 0.2s; display: grid; place-items: center; transform: scale(0.9); opacity: 0; }
.result-image-container:hover .overlay-icon-button { transform: scale(1); opacity: 1; }
.overlay-icon-button:nth-child(1) { transition-delay: 0.15s; }
.overlay-icon-button:nth-child(2) { transition-delay: 0.2s; }
.overlay-icon-button:nth-child(3) { transition-delay: 0.25s; }
.overlay-icon-button:hover:not(:disabled) { background-color: var(--card-background-color); transform: scale(1.1); }
.overlay-icon-button:disabled { background-color: var(--ui-background); color: var(--subtle-text-color); cursor: not-allowed; transform: scale(1); }
.overlay-icon-button svg { width: 18px; height: 18px; stroke: var(--text-color); }
.tooltip-wrapper { position: relative; }
.tooltip { position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%); background-color: var(--text-color); color: var(--card-background-color); padding: 0.25rem 0.6rem; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 500; white-space: nowrap; opacity: 0; visibility: hidden; transition: opacity 0.2s, visibility 0.2s; pointer-events: none; z-index: 2000; }
.tooltip-wrapper:hover .tooltip { opacity: 1; visibility: visible; transition-delay: 0.3s; }

.processing-overlay { position: absolute; inset: 0; background: color-mix(in srgb, var(--card-background-color) 80%, transparent); display: flex; flex-direction: column; gap: 0.5rem; align-items: center; justify-content: center; z-index: 10; font-weight: 600; color: var(--text-color); }
.play-icon-overlay { position: absolute; inset: 0; display: grid; place-items: center; background-color: rgba(15, 23, 42, 0.5); z-index: 5; opacity: 0; transition: opacity 0.3s; }
.result-image-container:hover .play-icon-overlay { opacity: 1; }

/* --- MODALS (PROJECTS, EDIT, FULL PREVIEW) --- */
.projects-modal-overlay, .edit-overlay, .full-preview-overlay { position: fixed; inset: 0; background-color: var(--modal-overlay-color); display: flex; align-items: center; justify-content: center; z-index: 1000; padding: 1rem; animation: fadeIn 0.3s ease; }

/* Full Preview Modal */
.full-preview-modal { background: var(--card-background-color); border-radius: 1rem; padding: 2rem; width: 100%; max-width: 800px; max-height: 90vh; display: flex; flex-direction: column; gap: 1.5rem; position: relative; }
.full-preview-image-wrapper { width: 100%; flex-grow: 1; display: flex; justify-content: center; align-items: center; overflow: hidden; min-height: 300px; background-color: var(--ui-background); border-radius: 0.5rem; }
.full-preview-image-wrapper img, .full-preview-image-wrapper video { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 0.5rem; }
.full-preview-actions { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; }
@media (min-width: 768px) { .full-preview-actions { grid-template-columns: repeat(6, 1fr); } }
.full-preview-actions button { background-color: var(--ui-background); color: var(--text-color); border: 1px solid var(--border-color); padding: 0.75rem; border-radius: 0.5rem; cursor: pointer; font-weight: 600; font-size: 0.9rem; transition: all 0.2s; display: flex; flex-direction: column; align-items: center; gap: 0.5rem; }
.full-preview-actions button:hover:not(:disabled) { border-color: var(--primary-color); color: var(--primary-color); background-color: var(--primary-background-subtle); }
.full-preview-actions button svg { width: 24px; height: 24px; }
.full-preview-actions button:disabled { opacity: 0.6; cursor: not-allowed; background-color: var(--ui-background-hover); border-color: var(--border-color); color: var(--subtle-text-color); }
.full-preview-close { position: absolute; top: 1rem; right: 1rem; width: 36px; height: 36px; border-radius: 50%; background-color: color-mix(in srgb, var(--background-color) 20%, transparent); color: var(--text-color); border: none; cursor: pointer; font-size: 20px; line-height: 36px; text-align: center; z-index: 10; transition: background-color 0.2s; }
.full-preview-close:hover { background-color: color-mix(in srgb, var(--background-color) 40%, transparent); }

/* Projects Modal */
.projects-modal { background: var(--card-background-color); border-radius: 1rem; padding: 2rem; width: 100%; max-width: 600px; max-height: 90vh; display: flex; flex-direction: column; position: relative; }
.projects-modal-header { display: flex; justify-content: center; align-items: center; margin-bottom: 1.5rem; }
.projects-modal h2 { text-align: center; }
.create-project-form { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; }
.create-project-form input { flex-grow: 1; font-size: 1rem; padding: 0.65rem 1rem; border: 1px solid var(--border-color); border-radius: 0.5rem; background-color: var(--card-background-color); color: var(--text-color); }
.create-project-form button { background-color: var(--primary-color); color: var(--text-color-inverted); border: none; border-radius: 0.5rem; padding: 0 1.5rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s; }
.create-project-form button:disabled { background-color: var(--primary-hover-color); opacity: 0.6; cursor: not-allowed; }
.projects-list { overflow-y: auto; display: flex; flex-direction: column; gap: 1rem; }
.project-item { display: flex; align-items: center; justify-content: space-between; gap: 1rem; background-color: var(--ui-background-subtle); padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border-color); }
.project-item-info { display: flex; flex-direction: column; }
.project-name { font-weight: 600; font-size: 1.1rem; }
.project-date { font-size: 0.8rem; color: var(--subtle-text-color); }
.project-item-actions { display: flex; gap: 0.5rem; }
.project-item-actions button { background-color: var(--ui-background); color: var(--text-color); border: 1px solid var(--border-color); padding: 0.4rem 0.8rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; font-size: 0.8rem; transition: all 0.2s; }
.project-item-actions button:hover { background-color: var(--ui-background-hover); border-color: var(--subtle-text-color); }
.project-item-actions button.load { background-color: var(--primary-color); color: var(--text-color-inverted); border-color: var(--primary-color); }
.project-item-actions button.load:hover { background-color: var(--primary-hover-color); }
.project-item-actions button.delete:hover { border-color: var(--error-color); background-color: var(--error-background-subtle); color: var(--error-color); }
.projects-empty-message { text-align: center; color: var(--subtle-text-color); padding: 2rem; }

/* Share Preview Page */
.share-preview-container { max-width: 1200px; margin: 0 auto; padding: 2rem 1rem; }
.share-preview-container header { border-bottom: 1px solid var(--border-color); padding-bottom: 1.5rem; }
.share-preview-main { padding-top: 2rem; }

/* Prompt Generator Modal */
.prompt-generator-modal { display: flex; flex-direction: column; gap: 1.5rem; background: var(--card-background-color); padding: 2rem; border-radius: 1rem; width: 100%; max-width: 800px; }
.prompt-generator-modal h3 { font-size: 1.5rem; text-align: center; }
.prompt-generator-modal p { color: var(--subtle-text-color); text-align: center; margin-top: -1rem; }
.prompt-generator-content { display: flex; flex-direction: column; gap: 2rem; }
@media (min-width: 768px) { .prompt-generator-content { flex-direction: row; } }
.prompt-generator-preview { flex: 1; display: flex; justify-content: center; align-items: center; background-color: var(--ui-background); border-radius: 0.5rem; overflow: hidden; }
.prompt-generator-preview img { max-width: 100%; max-height: 300px; object-fit: contain; }
.prompt-generator-controls { flex: 1.5; display: flex; flex-direction: column; gap: 1rem; }
.prompt-type-tabs { display: flex; gap: 0.5rem; border-bottom: 1px solid var(--border-color); }
.prompt-type-tabs button { background: none; border: none; padding: 0.5rem 1rem; cursor: pointer; font-weight: 500; color: var(--subtle-text-color); position: relative; bottom: -1px; border-bottom: 2px solid transparent; }
.prompt-type-tabs button.selected { color: var(--primary-color); border-bottom-color: var(--primary-color); }
.generated-prompt-wrapper { position: relative; flex-grow: 1; }
.generated-prompt-output { width: 100%; height: 100%; min-height: 200px; resize: none; background-color: var(--ui-background-subtle); border: 1px solid var(--border-color); border-radius: 0.5rem; padding: 1rem; font-family: 'Courier New', Courier, monospace; color: var(--text-color); }
.generated-prompt-output::placeholder { color: var(--subtle-text-color); }
.copy-prompt-button { position: absolute; top: 0.5rem; right: 0.5rem; background-color: var(--ui-background); color: var(--text-color); border: 1px solid var(--border-color); padding: 0.4rem 0.8rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; font-size: 0.8rem; transition: all 0.2s; }
.copy-prompt-button:hover { background-color: var(--ui-background-hover); border-color: var(--primary-color); }

/* Animation Modal */
.animation-modal { display: flex; flex-direction: column; gap: 1.5rem; background: var(--card-background-color); padding: 2rem; border-radius: 1rem; width: 100%; max-width: 800px; }
.animation-modal h3 { font-size: 1.5rem; text-align: center; }
.animation-modal p { color: var(--subtle-text-color); text-align: center; margin-top: -1rem; }
.animation-content { display: flex; flex-direction: column; gap: 2rem; }
@media (min-width: 768px) { .animation-content { flex-direction: row; } }
.animation-preview { flex: 1; display: flex; flex-direction: column; gap: 1rem; }
.animation-preview-frame {
  width: 100%;
  background-color: var(--background-color);
  border-radius: 0.5rem;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--border-color);
  transition: aspect-ratio 0.3s ease;
}
.animation-preview-frame img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.aspect-ratio-selector { display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap; }
.aspect-ratio-selector button { font-size: 0.8rem; background-color: var(--ui-background); color: var(--text-color); border: 1px solid var(--border-color); padding: 0.4rem 0.8rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; transition: all 0.2s; }
.aspect-ratio-selector button:hover { border-color: var(--primary-color); color: var(--primary-color); }
.aspect-ratio-selector button.selected { border-color: var(--primary-color); background-color: var(--primary-color); color: var(--text-color-inverted); }
.animation-preview-note { font-size: 0.8rem; color: var(--subtle-text-color); text-align: center; }
.animation-controls { flex: 1; display: flex; flex-direction: column; gap: 1rem; }
.animation-presets { display: flex; flex-direction: column; gap: 0.75rem; }
.animation-presets h4 { font-size: 0.9rem; font-weight: 600; margin: 0; }
.animation-presets-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; }
.animation-modal-actions { display: flex; gap: 1rem; justify-content: flex-end; margin-top: auto; }

.edit-modal { display: flex; gap: 2rem; background: var(--card-background-color); padding: 2rem; border-radius: 1rem; width: 100%; max-width: 1000px; max-height: 90vh; }
.edit-preview { flex: 2; display: flex; align-items: center; justify-content: center; overflow: hidden; background-color: var(--ui-background); border-radius: 0.5rem; }
.edit-preview-wrapper { position: relative; width: 100%; height: 100%; overflow: auto; display: flex; align-items: center; justify-content: center; }
.edit-preview-wrapper img { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 0.5rem; transition: transform 0.2s ease; transform-origin: center center; }
.mask-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: auto; opacity: 0.5; mix-blend-mode: normal; cursor: crosshair; }
.edit-sidebar { flex: 1; display: flex; flex-direction: column; gap: 1.5rem; overflow-y: auto; padding-right: 1rem; }
.edit-section { display: flex; flex-direction: column; gap: 0.75rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color); }
.edit-section:last-child { border-bottom: none; }
.edit-section h4 { font-size: 1.1rem; }
.edit-section p { font-size: 0.9rem; color: var(--subtle-text-color); }
.edit-sidebar textarea { width: 100%; min-height: 80px; padding: 0.5rem; border-radius: 0.5rem; border: 1px solid var(--border-color); font-family: inherit; font-size: 0.9rem; background-color: var(--card-background-color); color: var(--text-color); }
.preset-buttons-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; }
.preset-button { background: var(--ui-background); border: 1px solid var(--border-color); padding: 0.5rem; border-radius: 0.5rem; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 0.5rem; color: var(--text-color); font-size: 0.85rem; text-align: center; }
.preset-button:hover:not(:disabled) { background: var(--ui-background-hover); border-color: var(--primary-color); color: var(--primary-color); }
.preset-button:disabled { cursor: not-allowed; background-color: var(--ui-background-hover); color: var(--subtle-text-color); }
.adjustment-item { display: flex; flex-direction: column; gap: 0.25rem; }

.brush-controls { display: flex; flex-direction: column; gap: 0.75rem; }
.brush-actions { display: flex; gap: 0.5rem; }
.brush-actions button { flex: 1; background-color: var(--ui-background); color: var(--text-color); border: 1px solid var(--border-color); padding: 0.5rem; border-radius: 0.5rem; cursor: pointer; transition: all 0.2s; }
.brush-actions button:hover:not(:disabled) { background-color: var(--ui-background-hover); border-color: var(--primary-color); }
.brush-actions button:disabled { opacity: 0.5; cursor: not-allowed; }

.edit-section-action {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  cursor: pointer;
  transition: all 0.2s;
  width: 100%;
  margin-top: 0.5rem;
  padding: 0.75rem;
  border-radius: 0.5rem;
  background-color: var(--primary-color);
  color: var(--text-color-inverted);
  font-weight: 600;
  font-size: 0.95rem;
  border: 1px solid var(--primary-color);
}
.edit-section-action:hover:not(:disabled) { background-color: var(--primary-hover-color); border-color: var(--primary-hover-color); }
.edit-section-action:disabled { cursor: not-allowed; background-color: var(--primary-hover-color); border-color: var(--primary-hover-color); opacity: 0.7; }
.edit-section-action .spinner-ui { border-top-color: var(--text-color-inverted); }
.edit-section-action .spinner-dark { border-top-color: var(--text-color-inverted); border-left-color: rgba(255,255,255,0.3); border-right-color: rgba(255,255,255,0.3); border-bottom-color: rgba(255,255,255,0.3);}


.adjustment-item label { font-size: 0.9rem; font-weight: 500; }
.adjustment-slider { width: 100%; }
.edit-modal-actions { display: flex; gap: 1rem; margin-top: auto; }
.preview-download-button, .preview-close-button { padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 600; cursor: pointer; border: none; transition: background-color 0.2s; }
.preview-download-button { background-color: var(--primary-color); color: var(--text-color-inverted); }
.preview-download-button:hover { background-color: var(--primary-hover-color); }
.preview-close-button { background-color: var(--ui-background); color: var(--text-color); }
.preview-close-button:hover { background-color: var(--ui-background-hover); }

.zoom-controls { display: flex; align-items: center; gap: 0.5rem; justify-content: center; background-color: var(--ui-background); border-radius: 0.5rem; padding: 0.25rem; }
.zoom-controls button { width: 30px; height: 30px; border-radius: 0.25rem; border: 1px solid var(--border-color); background-color: var(--card-background-color); color: var(--subtle-text-color); cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.2s; }
.zoom-controls button:hover { border-color: var(--primary-color); color: var(--primary-color); }
.zoom-controls span { font-weight: 500; min-width: 50px; text-align: center; }

/* --- UTILITY --- */
.loading, .error { text-align: center; padding: 2rem; font-size: 1.125rem; border-radius: 0.5rem; }
.loading { color: var(--subtle-text-color); }
.error { color: var(--error-color); background-color: var(--error-background-subtle); border: 1px solid var(--error-color); }
.spinner { width: 20px; height: 20px; border: 2px solid color-mix(in srgb, var(--text-color-inverted) 30%, transparent); border-radius: 50%; border-top-color: var(--text-color-inverted); animation: spin 1s ease-in-out infinite; }
.spinner-ui { width: 16px; height: 16px; border: 2px solid color-mix(in srgb, var(--text-color) 20%, transparent); border-radius: 50%; border-top-color: var(--text-color); animation: spin 1s ease-in-out infinite; }
.spinner-dark { width: 16px; height: 16px; border: 2px solid rgba(0,0,0,0.2); border-radius: 50%; border-top-color: var(--text-color); animation: spin 1s ease-in-out infinite; }

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes spin { to { transform: rotate(360deg); } }
